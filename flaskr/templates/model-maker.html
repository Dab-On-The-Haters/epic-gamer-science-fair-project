{% import 'base.html.j2' as base %}
<!DOCTYPE html>
<html lang="en">
    <head>
        {{ base.head('Joe\'s Model Maker', css=['toggles', 'popups'], important=True) }}
        <script>
            var userMode = true;
            var toggleButton;
            var advancedFields = [];
            window.onload = function() {
                var advancedIds = JSON.parse('{{ advancedIDs|tojson }}');
                for (var i=0; i<advancedIds.length; i++) {
                    advancedFields.push(document.getElementById('div-' + advancedIds[i]));
                }
                toggleButton = document.getElementById("userMode");
            }

            function toggle() {
                if (userMode) {
                    toggleButton.innerHTML = "Switch to easy mode";
                    userMode = false;
                    for (var i=0; i<advancedFields.length; i++) {
                        advancedFields[i].style.display = "block";
                    }
                }
                else {
                    toggleButton.innerHTML = "Switch to advanced mode";
                    userMode = true;
                    for (var i=0; i<advancedFields.length; i++) {
                        advancedFields[i].style.display = "none";
                    }
                }
            }
        </script>
    </head>
    <body class="w3-text-white">
        {{ base.navbar(user, c='teach') }}
        {{ base.heading('Make a model') }}
        <div class="w3-container w3-margin">
            <form method="POST" target="_self">
                <p><b>Hover over any field's label for a more detailed explanation</b></p>
                <p><a href="/explore-datasets">Browse datasets</a></p>
                {% for field in form %}
                    {% if field.id == 'csrf_token' %}
                        {{ field }}
                    {% elif field.id == 'userMode' %}
                        <label class=" w3-margin-top w3-large switch">
                            Show advanced options
                            {{ field }}
                            <span class="slider round"></span>
                        </label>
                    {% else %}
                        <div id="div-{{ field.id }}" class="w3-margin-top" {% if (not form.userMode.data) or field.id in advancedIDs %} style="display: none;" {% endif %}>
                            <div>
                                {{ field.label|safe }}
                            </div>
                            {{ field }}
                        </div>
                    {% endif %}
                    <ul class="w3-ul w3-text-red">
                        {% for error in field.errors %}
                            <li>{{ error|escape }}</li>
                        {% endfor %}
                     </ul>
                {% endfor %}
                <br>
                <button type="submit" class="w3-button w3-xlarge w3-2019-galaxy-blue w3-right w3-margin w3-hover-indigo">Start training this model!</button>
            </form>
        </div>
    </body>
</html>
